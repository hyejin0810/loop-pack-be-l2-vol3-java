📋 감성 이커머스 플랫폼 요구사항 정의서

1. 목적 및 범위
   1.1 목적
   본 문서는 감성 이커머스 플랫폼의 핵심 기능에 대한 요구사항을 정의한다. 사용자가 브랜드 상품을 조회하고, 관심 상품을 관리하며, 주문할 수 있는 기본적인 이커머스 기능을 제공하는 것을 목표로 한다.
   1.2 범위
- 회원 가입 및 인증 
- 브랜드 및 상품 관리
- 좋아요 기능
- 장바구니 관리
- 주문 및 재고 관리
- 관리자 기능


2. 유저 시나리오
   2.1 일반 사용자 시나리오
   시나리오 1: 회원가입 및 로그인
1)사용자는 회원가입 페이지에서 로그인 ID, 비밀번호, 이름, 이메일, 전화번호를 입력한다.
2)시스템은 로그인 ID 중복을 확인한다.
3)시스템은 비밀번호를 암호화하여 저장한다.
4)사용자는 로그인 ID와 비밀번호로 로그인한다.
5)시스템은 JWT 토큰을 발급한다.
   시나리오 2: 상품 둘러보기
1)사용자는 메인 페이지에서 상품 목록을 조회한다.
2)사용자는 브랜드별, 가격순, 인기순으로 필터링 및 정렬한다.
3)사용자는 관심 있는 상품을 클릭하여 상세 정보를 확인한다.
4)상품 상세 페이지에서 가격, 재고, 브랜드 정보, 설명, 이미지를 확인한다.
   시나리오 3: 좋아요 관리
1)사용자는 마음에 드는 상품에 좋아요를 누른다.
2)시스템은 해당 상품의 좋아요 수를 증가시킨다.
3)사용자는 마이페이지에서 좋아요한 상품 목록을 확인한다.
4)사용자는 관심이 없어진 상품의 좋아요를 취소한다.
5)시스템은 해당 상품의 좋아요 수를 감소시킨다.
   시나리오 4: 장바구니 사용 (회원)
1)사용자는 상품 상세 페이지에서 수량을 선택하고 장바구니에 담는다. 
2)이미 담긴 상품인 경우 수량이 합산된다.
3)사용자는 장바구니 페이지에서 담긴 상품 목록을 확인한다.
4)시스템은 각 상품의 최신 가격과 재고 상태를 실시간으로 표시한다.
5)사용자는 필요시 수량을 변경하거나 상품을 삭제한다.
   시나리오 6: 주문하기
1)사용자는 장바구니 또는 상품 상세 페이지에서 주문하기를 클릭한다.
2)시스템은 선택한 모든 상품의 재고를 확인한다.
3)재고가 부족한 상품이 있으면 주문을 중단하고 알림을 표시한다.
4)모든 상품의 재고가 충분하면 재고를 차감한다.
5)시스템은 주문 정보를 생성하고 주문번호를 발급한다.
6)시스템은 주문 시점의 상품 정보(이름, 가격, 브랜드)를 스냅샷으로 저장한다.
7)장바구니에서 주문한 상품들을 삭제한다.
8)주문 상태는 PENDING으로 설정된다.
   시나리오 7: 주문 내역 조회
1)사용자는 마이페이지에서 주문 내역을 조회한다.
2)기간별로 필터링하여 원하는 주문을 찾는다.
3)특정 주문을 클릭하여 상세 정보를 확인한다.
4)주문 상세에는 주문 시점의 상품 정보(스냅샷)가 표시된다.
   시나리오 8: 주문 취소
1)사용자는 주문 내역에서 취소할 주문을 선택한다.
2)시스템은 주문 상태가 PENDING인지 확인한다.
3)CONFIRMED 상태라면 취소가 불가능함을 알린다.
4)PENDING 상태라면 주문을 취소하고 재고를 복구한다.
5)주문 상태를 CANCELLED로 변경하고 취소 일시를 기록한다.
   2.2 관리자 시나리오
   시나리오 9: 브랜드 관리
1)관리자는 관리자 페이지에 LDAP 인증으로 로그인한다.
2)브랜드 목록을 조회하고 페이징하여 확인한다.
3)새로운 브랜드를 등록한다 (이름, 설명).
4)기존 브랜드 정보를 수정한다.
5)필요시 브랜드를 삭제한다.
6)시스템은 브랜드 삭제 시 해당 브랜드의 모든 상품도 함께 삭제한다.
   시나리오 10: 상품 관리
1)관리자는 상품 목록을 조회한다 (브랜드별 필터 가능).
2)새로운 상품을 등록한다 (브랜드, 이름, 가격, 재고, 설명, 이미지).
3)시스템은 등록된 브랜드인지 확인한다.
4)기존 상품 정보를 수정한다 (단, 브랜드는 수정 불가).
5)재고를 조정한다.
6)필요시 상품을 삭제한다.
   시나리오 11: 주문 관리
1)관리자는 전체 주문 목록을 조회한다.
2)상태별(PENDING, CONFIRMED, CANCELLED)로 필터링한다.
3)PENDING 상태의 주문을 확인하고 CONFIRMED로 변경한다.
4)문제가 있는 주문은 CANCELLED로 변경한다.
5)주문 상세를 확인하여 스냅샷된 상품 정보를 검토한다.

3. 기능 요구사항 (유저 중심)
1. 일반 사용자 기능 (General User)
   [회원가입 및 인증]
   회원가입: ID(Unique), PW(BCrypt), 이름, 이메일, 연락처 입력

로그인: ID/PW 인증 후 JWT 발급

정보 수정: 비밀번호 변경 기능 제공

[상품 탐색]
조회: 상품 목록 조회 (Paging 지원)

필터/정렬: 브랜드별 필터링 및 최신/가격/인기순 정렬

상세 페이지: 상품 정보(이름, 가격, 재고, 브랜드, 설명, 이미지) 확인

예외: 소프트 삭제된 상품은 노출 제외

[좋아요 관리]
등록/취소: 상품 좋아요 클릭 시 likes_count 증감 (1인 1회 제한)

목록 조회: 내가 좋아요를 누른 상품 리스트 확인

[장바구니]
담기: 수량 선택 후 저장 (중복 상품 시 수량 합산, 최대 100개 제한)

상태 반영: 실시간 가격/재고 표시 (품절 및 삭제 상품 구분 표시)

관리: 개별 삭제, 수량 변경, 전체 비우기 지원

자동화: 30일 경과 항목 새벽 3시 배치 삭제

[주문 시스템]
주문 실행: 전 상품 재고 확인 후 주문번호 생성 및 장바구니 비우기

재고 로직: 부족 시 주문 실패, 성공 시 즉시 차감 (낙관적 락 적용)

스냅샷: 주문 시점의 상품 정보(가격, 브랜드 등)를 별도 저장

취소: PENDING 상태만 가능, 취소 시 재고 복구 (CONFIRMED 불가)


[주문 운영]
모니터링: 전체 주문 목록 조회 및 상태별 필터링
상태 변경: PENDING → CONFIRMED (승인) 또는 CANCELLED (취소)
상세 검토: 주문 당시의 스냅샷 데이터 확인

3.2 관리자가 할 수 있는 것
🏢 브랜드 관리
나는 브랜드를 등록할 수 있다
브랜드명과 설명을 입력하여 등록
나는 브랜드 목록을 조회할 수 있다
페이징으로 관리 가능
삭제된 브랜드는 목록에서 제외됨
나는 브랜드 정보를 수정할 수 있다
브랜드명, 설명 수정 가능
나는 브랜드를 삭제할 수 있다
브랜드 삭제 시 해당 브랜드의 모든 상품도 함께 삭제됨
실제 삭제가 아닌 소프트 삭제 (복구 가능)




📦 상품 관리
나는 상품을 등록할 수 있다
등록된 브랜드에만 상품을 추가할 수 있다
존재하지 않는 브랜드로는 등록 불가
나는 상품 목록을 조회할 수 있다
브랜드별로 필터링 가능
페이징으로 관리 가능
나는 상품 정보를 수정할 수 있다
상품명, 가격, 재고, 설명, 이미지 수정 가능
단, 브랜드는 변경할 수 없다
나는 상품을 삭제할 수 있다

실제 삭제가 아닌 소프트 삭제 (복구 가능)


나는 재고를 조정할 수 있다

재고는 0 미만으로 내려갈 수 없다




🧾 주문 관리
AS 관리자

나는 전체 주문 목록을 조회할 수 있다

상태별(PENDING, CONFIRMED, CANCELLED)로 필터링 가능


나는 주문 상세를 확인할 수 있다

주문 당시의 상품 정보(스냅샷)를 검토할 수 있다


나는 PENDING 상태의 주문을 확인할 수 있다

PENDING → CONFIRMED로 변경 가능


나는 문제가 있는 주문을 취소할 수 있다

PENDING 상태의 주문만 취소 가능
취소 시 재고 복구됨




3.3 시스템 동작 규칙
🔒 동시성 제어

재고 차감: 낙관적 락(version 컬럼) 사용

여러 사용자가 동시에 같은 상품을 주문해도 재고가 정확히 차감됨
version 불일치 시 주문 실패 후 재시도 유도


좋아요 수: 트랜잭션으로 처리

좋아요 등록/취소와 좋아요 수 증감이 동시에 처리됨



📸 스냅샷 저장

주문 시점의 상품 정보를 ORDER_ITEMS에 저장

상품명, 가격, 브랜드명, 이미지
나중에 상품 정보가 변경되어도 주문 내역은 그대로 유지됨



🗑️ 소프트 삭제

브랜드와 상품은 실제로 삭제되지 않음

deleted_at 컬럼에 삭제 일시만 기록
일반 사용자에게는 노출되지 않음
관리자는 복구 가능

4. 예외 및 정책
   4.1 재고 관련 예외

재고 부족: 주문 시 재고가 부족하면 주문이 실패하고 사용자에게 "재고가 부족합니다"라는 메시지를 표시한다.
동시 재고 차감: 낙관적 락을 사용하여 동시에 재고를 차감하려는 경우 version 불일치로 실패 처리하고 재시도를 유도한다.

4.2 좋아요 관련 예외

중복 좋아요: 불가 1회만가능
4.3 장바구니 관련 예외

중복 담기: 이미 장바구니에 있는 상품을 다시 담으면 기존 수량에 추가 수량을 합산한다.
최대 개수 초과: 장바구니에 100개 이상의 상품을 담으려고 하면 "장바구니는 최대 100개까지 담을 수 있습니다"라는 메시지를 표시한다.

4.4 주문 관련 예외

취소 불가 상태: CONFIRMED 상태에서 취소를 시도하면 "이미 확인된 주문은 취소할 수 없습니다"라는 메시지를 표시한다.
브랜드 없음: 존재하지 않는 브랜드로 상품을 등록하려고 하면 "존재하지 않는 브랜드입니다"라는 메시지를 표시한다.

4.5 정책

소프트 삭제: 브랜드와 상품은 실제로 삭제하지 않고 deleted_at 값을 기록한다.
스냅샷 저장: 주문 시점의 상품 정보를 ORDER_ITEMS에 저장하여 나중에 상품 정보가 변경되어도 주문 내역은 유지된다.
자동 삭제: 30일이 지난 장바구니 항목은 매일 새벽 3시에 배치로 자동 삭제된다.
트랜잭션: 주문 생성, 재고 차감, 좋아요 증감은 모두 트랜잭션으로 처리하여 일관성을 보장한다.


5. 해당 범위에서 제외하는 것
   5.1 현재 범위에서 제외
   다음 기능들은 현재 개발 범위에 포함되지 않으며, 추후 확장 시 고려된다:
   결제 기능




6. 용어 정의
   6.1 용어 정의

회원: 시스템에 가입하고 로그인한 사용자
비회원: 로그인하지 않은 사용자
관리자: LDAP 인증을 통해 관리 기능에 접근할 수 있는 사용자
소프트 삭제: 실제 데이터를 삭제하지 않고 deleted_at 컬럼에 삭제 일시를 기록하는 방식
스냅샷: 특정 시점의 데이터를 별도로 저장하여 원본 데이터 변경에 영향받지 않도록 하는 방식


6.2 상태 코드

PENDING: 주문 대기 중
CONFIRMED: 주문 확인됨 (관리자 승인)
CANCELLED: 주문 취소됨

6.3 고정 제약사항

장바구니 최대 상품 개수: 100개
장바구니 자동 삭제 기간: 30일
비밀번호 암호화 알고리즘: BCrypt
인증 방식: JWT